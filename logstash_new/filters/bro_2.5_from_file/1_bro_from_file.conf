input {
###########################
###BRO_CONN File Input#####
###########################	
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/conn.*.log" 
		sincedb_path => "/data_bro/since_db2/.conn_log"
		close_older => 3600000		
		type => "bro_conn"
	}
###########################
#BRO_DARK_HOST File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/dark_host*.log" 
		sincedb_path => "/data_bro/since_db2/.dark_host_log"
		close_older => 3600000		
		type => "bro_dark_host"
	}
###########################
#BRO_DCE_RPC File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/dce_rpc*.log" 
		sincedb_path => "/data_bro/since_db2/.dce_rpc_log"
		close_older => 3600000		
		type => "bro_dce_rpc"
	}
###########################
#BRO_DHCP File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/dhcp*.log" 
		sincedb_path => "/data_bro/since_db2/.dhcp_log"
		close_older => 3600000		
		type => "bro_dhcp"
	}
###########################
#BRO_DNP3 File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/dnp3*.log" 
		sincedb_path => "/data_bro/since_db2/.dnp3_log"
		close_older => 3600000		
		type => "bro_dnp3"
	}
###########################
#BRO_DNS File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/dns*.log" 
		sincedb_path => "/data_bro/since_db2/.dns_log"
		close_older => 3600000		
		type => "bro_dns"
	}
###########################
#####BRO_FILES File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/files*.log" 
		sincedb_path => "/data_bro/since_db2/.files_log"
		close_older => 3600000		
		type => "bro_files"
	}
###########################
#######BRO_FTP File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/ftp*.log" 
		sincedb_path => "/data_bro/since_db2/.ftp_log"
		close_older => 3600000		
		type => "bro_ftp"
	}
###########################
#####BRO_HTTP File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/http_eth*.log" 
		sincedb_path => "/data_bro/since_db2/.http_log"
		close_older => 3600000		
		type => "bro_http"
	}
###########################
#######BRO_INTEL File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/intel*.log" 
		sincedb_path => "/data_bro/since_db2/.intel_log"
		close_older => 3600000		
		type => "bro_intel"
	}
###########################
#####BRO_IRC File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/irc*.log" 
		sincedb_path => "/data_bro/since_db2/.irc_log"
		close_older => 3600000		
		type => "bro_irc"
	}
###########################
##BRO_KERBEROS File Input##
###########################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/kerberos*.log" 
		sincedb_path => "/data_bro/since_db2/.kerberos_log"
		close_older => 3600000		
		type => "bro_kerberos"
	}
#################################
###BRO_KNOWN_HOSTS File Input####
#################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/known_hosts*.log" 
		sincedb_path => "/data_bro/since_db2/.known_hosts_log"
		close_older => 3600000		
		type => "bro_known_hosts"
	}
##################################
###BRO_KNOWN_SERVICES File Input##
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/known_services*.log" 
		sincedb_path => "/data_bro/since_db2/.known_services_log"
		close_older => 3600000		
		type => "bro_known_services"
	}
############################
#####BRO_MODBUS File Input##
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/modbus*.log" 
		sincedb_path => "/data_bro/since_db2/.modbus_log"
		close_older => 3600000		
		type => "bro_modbus"
	}
#########################################
##BRO_MODBUS_REGISTER_CHANGE File Input##
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/modbus_register_change*.log" 
		sincedb_path => "/data_bro/since_db2/.modbus_register_change_log"
		close_older => 3600000		
		type => "bro_modbus_register_change"
	}
##################################
###BRO_MYSQL File Input##
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/mysql*.log" 
		sincedb_path => "/data_bro/since_db2/.mysql_log"
		close_older => 3600000		
		type => "bro_mysql"
	}
############################
#####BRO_NOTICE File Input##
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/notice*.log" 
		sincedb_path => "/data_bro/since_db2/.notice_log"
		close_older => 3600000		
		type => "bro_notice"
	}
#########################################
####BRO_NTLM File Input##################
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/ntlm*.log" 
		sincedb_path => "/data_bro/since_db2/.ntlm_log"
		close_older => 3600000		
		type => "bro_ntlm"
	}
##################################
###BRO_PE File Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/pe*.log" 
		sincedb_path => "/data_bro/since_db2/.pe_log"
		close_older => 3600000		
		type => "bro_pe"
	}
############################
#####BRO_RADIUS File Input##
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/radius*.log" 
		sincedb_path => "/data_bro/since_db2/.radius_log"
		close_older => 3600000		
		type => "bro_radius"
	}
#########################################
####BRO_RDP File Input##################
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/rdp*.log" 
		sincedb_path => "/data_bro/since_db2/.rdp_log"
		close_older => 3600000		
		type => "bro_rdp"
	}
##################################
###BRO_RFB File Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/rfb*.log" 
		sincedb_path => "/data_bro/since_db2/.rfb_log"
		close_older => 3600000		
		type => "bro_rfb"
	}
############################
#####BRO_SIGNATURES File Input##
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/signatures*.log" 
		sincedb_path => "/data_bro/since_db2/.signatures_log"
		close_older => 3600000		
		type => "bro_signatures"
	}
#########################################
####BRO_SIP File Input##################
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/sip*.log" 
		sincedb_path => "/data_bro/since_db2/.sip_log"
		close_older => 3600000		
		type => "bro_sip"
	}
##################################
###BRO_SMB_CMD File Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/smb_cmd*.log" 
		sincedb_path => "/data_bro/since_db2/.smb_cmd_log"
		close_older => 3600000		
		type => "bro_smb_cmd"
	}
############################
#####BRO_SMB_FILES File Input#####
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/smb_files*.log" 
		sincedb_path => "/data_bro/since_db2/.smb_log"
		close_older => 3600000		
		type => "bro_smb_files"
	}
#########################################
####BRO_SMB_MAPPING File Input###########
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/smb_mapping*.log" 
		sincedb_path => "/data_bro/since_db2/.smb_mapping_log"
		close_older => 3600000		
		type => "bro_smb_mapping"
	}
##################################
###BRO_SMTP Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/smtp*.log" 
		sincedb_path => "/data_bro/since_db2/.smtp_log"
		close_older => 3600000		
		type => "bro_smtp"
	}
############################
#####BRO_SNMP File Input#####
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/snmp*.log" 
		sincedb_path => "/data_bro/since_db2/.snmp_log"
		close_older => 3600000		
		type => "bro_snmp"
	}
#########################################
####BRO_SOCKS File Input###########
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/socks*.log" 
		sincedb_path => "/data_bro/since_db2/.socks_log"
		close_older => 3600000		
		type => "bro_socks"
	}
##################################
###BRO_SOFTWARE  Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/software*.log" 
		sincedb_path => "/data_bro/since_db2/.software_log"
		close_older => 3600000		
		type => "bro_software"
	}
############################
#####BRO_SSH File Input#####
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/ssh*.log" 
		sincedb_path => "/data_bro/since_db2/.ssh_log"
		close_older => 3600000		
		type => "bro_ssh"
	}
#########################################
####BRO_SSL File Input###########
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/ssl*.log" 
		sincedb_path => "/data_bro/since_db2/.ssl_log"
		close_older => 3600000		
		type => "bro_ssl"
	}
##################################
###BRO_SYSLOG  Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/syslog*.log" 
		sincedb_path => "/data_bro/since_db2/.syslog_log"
		close_older => 3600000		
		type => "bro_syslog"
	}
############################
#####BRO_TRACEROUTE File Input#####
############################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/traceroute*.log" 
		sincedb_path => "/data_bro/since_db2/.traceroute_log"
		close_older => 3600000		
		type => "bro_traceroute"
	}
#########################################
####BRO_TUNNEL File Input###########
#########################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/tunnel*.log" 
		sincedb_path => "/data_bro/since_db2/.tunnel_log"
		close_older => 3600000		
		type => "bro_tunnel"
	}
##################################
###BRO_WEIRD  Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/weird*.log" 
		sincedb_path => "/data_bro/since_db2/.weird_log"
		close_older => 3600000		
		type => "bro_weird"
	}
##################################
###BRO_X509  Input#############
##################################
	file {
		start_position => "beginning"
		path => "/data_bro/brologs2/2016*/x509*.log" 
		sincedb_path => "/data_bro/since_db2/.x509_log"
		close_older => 3600000		
		type => "bro_x509"
	}

}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=Preproccesor Filter=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
		if [message] =~ /^#/ {
			drop {}
		}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_conn=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_conn" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"proto",
			"service",
			"duration",
			"src_bytes",
			"dst_bytes",
			"conn_state",
			"local_src",
			"local_dst",
			"missed_bytes",
			"history",
			"src_pkts",
			"src_ip_bytes",
			"dst_pkts",
			"dst_ip_bytes",
			"tunnel_parents",
			"src_cc",
			"dst_cc",
			"sensor_name",
			"vlan",
			"inner_vlan"
			]
			separator => "	"
		}
		geoip {
			source => "dst_ip"
		}
	} 
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_dark_host=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_dark_host" {
		csv {
			columns => [
			"ts",
			"host",
			"event_type",
			"last_seen"
			]
			separator => "	"
		}
		date {
			match => ["last_seen", "UNIX"]
			target => "last_seen"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_dce_rpc=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_dce_rpc" {
		grok {
			match => [ "message", "^%{DATA:ts}\t%{DATA:uid}\t%{DATA:src_ip}\t%{DATA:src_port}\t%{DATA:dst_ip}\t%{DATA:dst_port}\t%{DATA:rtt}\t%{DATA:named_pipe}\t%{DATA:endpoint}\t%{DATA:operation}$" ]
			remove_field => [ "message" ]
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_dhcp	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_dhcp" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"mac",
			"assigned_ip",
			"lease_time",
			"trans_id"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_dnp3	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_dnp3" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"fc_request",
			"fc_reply",
			"iin"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_dns	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_dns" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"proto",
			"trans_id",
			"rtt",
			"query",
			"qclass",
			"qclass_name",
			"qtype",
			"qtype_name",
			"rcode",
			"rcode_name",
			"AA",
			"TC",
			"RD",
			"RA",
			"Z",
			"answers",
			"TTLs",
			"rejected",
			"total_answers",
			"total_replies",
			"saw_query",
			"saw_reply",
			"auth",
			"addl"
			]
			separator => "	"
		}	
		geoip {
			source => "dst_ip"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_files	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_files" {
		csv {
			columns => [
			"ts",
			"fuid",
			"tx_hosts",
			"rx_hosts",
			"conn_uids",
			"source",
			"depth",
			"analyzers",
			"mime_type",
			"filename",
			"duration",
			"local_src",
			"is_src",
			"seen_bytes",
			"total_bytes",
			"missing_bytes",
			"overflow_bytes",
			"timedout",
			"parent_fuid",
			"md5",
			"sha1",
			"sha256",
			"extracted"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_ftp	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_ftp" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"user",
			"password",
			"command",
			"arg",
			"mime_type",
			"file_size",
			"reply_code",
			"reply_msg",
			"data_channel_passivel",
			"data_channel_src_ip",
			"data_channel_dst_ip",
			"data_channel_dst_port",
			"fuid"
			]
			separator => "	"
		}
		mutate {
			convert => [ "reply_code", "integer" ]
			}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_http	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_http" {
		grok {
			match => [ "message", "^(?<ts>(.*?))\t(?<uid>(.*?))\t(?<src_ip>(.*?))\t(?<src_port>(.*?))\t(?<dst_ip>(.*?))\t(?<dst_port>(.*?))\t(?<trans_depth>(.*?))\t(?<method>(.*?))\t(?<host>(.*?))\t(?<uri>(.*?))\t(?<referrer>(.*?))\t(?<version>(.*?))\t(?<user_agent>(.*?))\t(?<request_body_len>(.*?))\t(?<response_body_len>(.*?))\t(?<status_code>(.*?))\t(?<status_msg>(.*?))\t(?<info_code>(.*?))\t(?<info_msg>(.*?))\t(?<http_tags>(.*?))\t(?<username>(.*?))\t(?<password>(.*?))\t(?<proxied>(.*?))\t(?<src_fuids>(.*?))\t(?<src_filenames>(.*?))\t(?<src_mime_types>(.*?))\t(?<dst_fuids>(.*?))\t(?<dst_filenames>(.*?))\t(?<dst_mime_types>(.*))$" ]
			remove_field => [ "message" ]
		}
		geoip {
			source => "dst_ip"
		}
	}
}

#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_intel	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_intel" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"seen_indicator",
			"seen_indicator_type",
			"seen_where",
			"seen_node",
			"matched",
			"sources",
			"fuid",
			"file_mime_type",
			"file_desc"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_irc	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_irc" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"nickname",
			"user",
			"command",
			"value",
			"addl",
			"dcc_file_name",
			"dcc_file_size",
			"dcc_mime_type",
			"fuid"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_kerberos	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_kerberos" {
		grok {
			match => [ "message", "^(?<ts>(.*?))\t(?<uid>(.*?))\t(?<src_ip>(.*?))\t(?<src_port>(.*?))\t(?<dst_ip>(.*?))\t(?<dst_port>(.*?))\t(?<request_type>(.*?))\t(?<client>(.*?))\t(?<service>(.*?))\t(?<success>(.*?))\t(?<error_msg>(.*?))\t(?<valid_from>(.*?))\t(?<valid_till>(.*?))\t(?<cipher>(.*?))\t(?<forwardable>(.*?))\t(?<renewable>(.*?))\t(?<client_cert_subj>(.*?))\t(?<client_cert_fuid>(.*?))\t(?<server_cert_subj>(.*?))\t(?<server_cert_fuid>(.*))$" ]
			remove_field => [ "message" ]
		}
		date { match => [ "valid_from", "UNIX" ] 
         target => "valid_from"}
        date { match => [ "valid_till", "UNIX" ] 
         target => "valid_till"}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_known_hosts	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_known_hosts" {
		csv {
			columns => [
			"ts",
			"host"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_known_services	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_known_services" {
		csv {
			columns => [
			"ts",
			"host",
			"port",
			"port_proto",
			"service"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_modbus	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_modbus" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"id",
			"func",
			"exception",
			"track_address"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-==========
#=-=bro_modbus_register_change	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-=========
filter {
	if [type] == "bro_modbus_register_change" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"register",
			"old_val",
			"new_val",
			"delta"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_mysql	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_mysql" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"cmd",
			"arg",
			"success",
			"rows",
			"response"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_notice	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_notice" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"fuid",
			"file_mime_type",
			"file_desc",
			"proto",
			"note",
			"msg",
			"sub",
			"src",
			"dst",
			"port",
			"count",
			"peer_descr",
			"actions",
			"suppress_for",
			"dropped",
			"remote_location.country_code",
			"remote_location.region",
			"remote_location.city",
			"remote_location.latitude",
			"remote_location.longitude"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_ntlm	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_ntlm" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"username",
			"hostname",
			"domainname",
			"success",
			"status",
			"done"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_pe	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_pe" {
		csv {
			columns => [
			"ts",
			"id",
			"machine",
			"compile_ts",
			"os",
			"subsystem",
			"is_exe",
			"is_64bit",
			"uses_aslr",
			"uses_dep",
			"uses_code_integrity",
			"uses_seh",
			"has_import_table",
			"has_export_table",
			"has_cert_table",
			"has_debug_data",
			"section_names"
			]
			separator => "	"
		}
		date { match => [ "compile_ts", "UNIX" ] 
         target => "compile_ts"}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_radius	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_radius" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"username",
			"mac",
			"remote_ip",
			"connect_info",
			"result",
			"logged"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_rdp	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_rdp" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"cookie",
			"result",
			"security_proto",
			"keyboard_layout",
			"client_build",
			"client_name",
			"client_dig_pro_id",
			"desk_width",
			"desk_height",
			"req_color_depth",
			"cert_type",
			"cert_count",
			"cert_perm",
			"encryption_lvl",
			"encryption_meth"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_rfb	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_rfb" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"client_major_version",
			"client_minor_version",
			"server_major_version",
			"server_minor_version",
			"auth_meth",
			"auth",
			"share_flag",
			"desktop_name",
			"width",
			"height"
			]
			separator => "	"
		}
	}
}

#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_signatures	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_signatures" {
		csv {
			columns => [
			"ts",
			"src_addr",
			"src_port",
			"dst_addr",
			"dst_port",
			"note",
			"sig_id",
			"event_msg",
			"sub_msg",
			"sig_count",
			"host_count"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_sip	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_sip" {
		grok {
			match => [ "message", "^%{DATA:ts}\t%{DATA:uid}\t%{DATA:src_ip}\t%{DATA:src_port}\t%{DATA:dst_ip}\t%{DATA:dst_port}\t%{DATA:trans_depth}\t%{DATA:method}\t%{DATA:uri}\t%{DATA:date}\t%{DATA:request_from}\t%{DATA:request_to}\t%{DATA:response_from}\t%{DATA:response_to}\t%{DATA:reply_to}\t%{DATA:call_id}\t%{DATA:seq}\t%{DATA:subject}\t%{DATA:request_path}\t%{DATA:response_path}\t%{DATA:user_agent}\t%{DATA:status_code}\t%{DATA:status_msg}\t%{DATA:warning}\t%{DATA:request_body_len}\t%{DATA:response_body_len}\t%{DATA:content_type}$" ]
			remove_field => [ "message" ]
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_smb_cmd	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_smb_cmd" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"command",
			"sub_command",
			"argument",
			"status",
			"rtt",
			"version",
			"username",
			"tree",
			"tree_service",
			"referenced_file",
			"referenced_tree",
			"smb1_offered_dialects",
			"smb2_offered_dialects"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_smb_files	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_smb_files" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"fuid",
			"action",
			"path",
			"name",
			"size",
			"prev_name",
			"times_modified",
			"times_accessed",
			"times_created",
			"times_changed",
			"fid",
			"uuid"
			]
			separator => "	"
		}
		date { match => [ "times_modified", "UNIX" ] 
         target => "times_modified"}
        date { match => [ "times_accessed", "UNIX" ] 
         target => "times_accessed"}
        date { match => [ "times_created", "UNIX" ] 
         target => "times_created"}
        date { match => [ "times_changed", "UNIX" ] 
         target => "times_changed"}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_smb_mapping	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_smb_mapping" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"path",
			"service",
			"native_file_sys",
			"share_type"
			]
			separator => "	"
			}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_smtp	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_smtp" {
		grok {
			match => [ "message", "^%{DATA:ts}\t%{DATA:uid}\t%{DATA:src_ip}\t%{DATA:src_port}\t%{DATA:dst_ip}\t%{DATA:dst_port}\t%{DATA:trans_depth}\t%{DATA:helo}\t%{DATA:mailfrom}\t%{DATA:rcptto}\t%{DATA:date}\t%{DATA:from}\t%{DATA:to}\t%{DATA:cc}\t%{DATA:reply_to}\t%{DATA:msg_id}\t%{DATA:in_reply_to}\t%{DATA:subject}\t%{DATA:x_originating_ip}\t%{DATA:first_received}\t%{DATA:second_received}\t%{DATA:last_reply}\t%{DATA:path}\t%{DATA:user_agent}\t%{DATA:tls}\t%{DATA:fuids}\t%{DATA:is_webmail}$" ]
			remove_field => [ "message" ]
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_snmp	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_snmp" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"duration",
			"version",
			"community",
			"get_requests",
			"get_bulk_requests",
			"get_responses",
			"set_requests",
			"display_string",
			"up_since"
			]
			separator => "	"
		}
	}
}

#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_socks	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_socks" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"version",
			"user",
			"password",
			"status",
			"request_host",
			"request_name",
			"request_port",
			"bound_host",
			"bound_name",
			"bound_port"
			]
			separator => "	"
		}
	}
}

#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_software	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_software" {
		csv {
			columns => [
			"ts",
			"host",
			"host_port",
			"software_type",
			"name",
			"version_major",
			"version_minor",
			"version_minor2",
			"version_minor3",
			"version_addl",
			"unparsed_version"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_ssh	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_ssh" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"version",
			"auth_success",
			"direction",
			"client",
			"server",
			"cipher_alg",
			"mac_alg",
			"compress_alg",
			"kex_alg",
			"host_key_alg",
			"host_key",
			"remote_location.country_code",
			"remote_location.region",
			"remote_location.city",
			"remote_location.latitude",
			"remote_location.longitude"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_ssl	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_ssl" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"version",
			"cipher",
			"curve",
			"server_name",
			"resumed",
			"last alert",
			"next_proto",
			"established",
			"cert_chain_fuids",
			"client_cert_chain_fuids",
			"subject",
			"issuer",
			"client_subject",
			"client_issuer",
			"client_ciphers",
			"validation_status"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_syslog	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_syslog" {
		grok {
			match => [ "message", "^%{DATA:ts}\t%{DATA:uid}\t%{DATA:src_ip}\t%{DATA:src_port}\t%{DATA:dst_ip}\t%{DATA:dst_port}\t%{DATA:proto}\t%{DATA:facility}\t%{DATA:severity}\t%{DATA:messages}$" ]
			remove_field => [ "message" ]
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_traceroute	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_traceroute" {
		csv {
			columns => [
			"ts",
			"src_ip",
			"dst_ip",
			"proto"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_tunnels	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_tunnel" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"tunnel_type",
			"action"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_weird	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_weird" {
		csv {
			columns => [
			"ts",
			"uid",
			"src_ip",
			"src_port",
			"dst_ip",
			"dst_port",
			"name",
			"addl",
			"notice",
			"peer"
			]
			separator => "	"
		}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=bro_x509	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
	if [type] == "bro_x509" {
		csv {
			columns => [
			"ts",
			"id",
			"certificate.version",
			"certificate.serial",
			"certificate.subject",
			"certificate.issuer",
			"certificate.not_valid_before",
			"certificate.not_valid_after",
			"certificate.key_alg",
			"certificate.sig_alg",
			"certificate.key_type",
			"certificate.key_length",
			"certificate.exponent",
			"certificate.curve",
			"san.dns",
			"san.uri",
			"san.email",
			"san.ip",
			"basic_constraints.ca",
			"basic_constraints.path_len"
			]
			separator => "	"
		}
		date { match => [ "certificate.not_valid_before", "UNIX" ] 
         target => "certificate.not_valid_before"}
        date { match => [ "certificate.not_valid_after", "UNIX" ] 
         target => "certificate.not_valid_after"}
	}
}
#=-=-=-=-=-=-=-=--=-=-=-=-=-=
#=-=POSTPROCESSOR	=-=--=
#-=-==-=-=-=-=-=-=-=-=-=-=-=-
filter {
		mutate {
			convert => [ "bytes", "integer" ]
			convert => [ "duration", "float" ]
			convert => [ "src_bytes", "integer" ]
			convert => [ "dst_bytes", "integer" ]
			convert => [ "missed_bytes", "integer" ]
			convert => [ "src_pkts", "integer" ]
			convert => [ "dst_pkts", "integer" ]
			convert => [ "src_ip_bytes", "integer" ]
			convert => [ "dst_ip_bytes", "integer" ]
			convert => [ "missing_bytes", "integer" ]
			convert => [ "total_bytes", "integer" ]
			convert => [ "overflowing_bytes", "integer" ]
			convert => [ "depth", "integer" ]
			convert => [ "seen_bytes", "integer" ]
			convert => [ "overflow_bytes", "integer" ]
			convert => [ "trans_depth", "integer" ]
			convert => [ "request_body_len", "integer" ]
			convert => [ "response_body_len", "integer" ]
			convert => [ "status_code", "integer" ]
			convert => [ "info_code", "integer" ]
			convert => [ "port", "integer" ]
			convert => [ "count", "integer" ]
			convert => [ "suppress_for", "float" ]
			convert => [ "src_port", "integer" ]
			convert => [ "dst_port", "integer" ]
#			remove_field => [ "beat.name" ]
#			remove_field => [ "beat.version" ]
			remove_tag => [ "_dateparsefailure" ]
			remove_tag => [ "_geoip_lookup_failure" ]
#			remove_tag => [ "beats_input_codec_plain_applied" ]
		}
		date { match => [ "ts", "UNIX" ]
		remove_field => [ "ts" ]
		}
}
#==================================
#	OUTPUT SECTION	===========
#==================================
output {
#	stdout { codec => rubydebug }
  elasticsearch {
    index => "logstash-broarchived-%{+YYYY.MM.dd}"
    hosts => ["10.20.52.151"]
#    hosts => [ "10.20.52.149", "10.20.52.150", "10.20.52.151", "10.20.52.153", "10.20.52.154", "10.20.52.155" ]
    flush_size => 7500
    pool_max => 5000
    pool_max_per_route => 2500
    retry_initial_interval => 10
    timeout => 120
  }
}
