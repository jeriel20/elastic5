portvar HIGH_PORTS [1024:65535]
#COUNTRY 1 - Snort Signature 100000[1-23]
alert tcp any any -> any any (msg: "FF-RAT version 1 binary beacon"; content:"|d8 d8 d8 d8 37 27 27 26 23 27 27 27|"; depth:12; sid: 1000000; rev: 1;)
alert tcp any any -> any any (msg: "FF-RAT version 2 binary beacon"; content:"|d8 d8 d8 d8 27 26 27 27 26 27 27 27|"; depth:12; sid: 1000001; rev: 1;)
alert tcp any any -> any any (msg: "FF-RAT version 3 binary beacon"; content:"|d8 d8 d8 d8 27 26 27 27 27 27 27 27|"; depth:12; sid: 1000002; rev: 1;)
alert tcp any any -> any any (msg: "FF-RAT version 4 binary beacon"; content:"|d8 d8 d8 d8 37 27 27 26 24 27 27 27|"; depth:12; sid: 1000003; rev: 1;)
alert tcp any any -> any any (msg: "FF-RAT version 5 binary beacon"; content:"|37 27 27 26 26 27 27 27 e7 30 27 27|"; depth:12; sid: 1000004; rev: 1;)
alert tcp any [5198,6060] -> any any (msg: "FF-RAT server response"; content:"|10 00 00 01 10 00 00 01|"; depth:8; sid:1000005; rev:1;)
alert tcp any any -> any any (msg: "FF-RAT binary beacon"; content:"|d8 d8 d8 d8|"; offset: 0; depth:4; content:"|0a|"; distance: 20; within: 1; content:"|0a|"; distance: 4; within: 1; content:"|0a|"; distance: 4; within: 1; content:"|0a|"; distance: 4; within: 1; sid: 1000006; rev: 1;)
alert tcp any any -> any any (msg:"SOGU/PlugX beacon with OldServer PostSize PostSerial in http header"; content:"POST"; http_method; content:"/update?id="; http_uri; content:"OldServer:"; http_header; content:"PostSize:"; http_header; content:"PostSerial:"; http_header; sid: 1000007; rev: 1;)
alert tcp any any <> any [80,443] (msg:"Malicious GET request for Sogu"; content:"GET /"; PCRE:"/[A-Z0-9]{24}/"; sid:10000024;)
alert tcp any any <> any [80,443] (msg:"Malicious AppleId header for Sogu"; content:"AppleId:"; PCRE:"/[A-Za-z0-9+\/=]{28}/"; sid:1000008;)
alert tcp any any -> any any  (msg:" SOGU_Implant_Traffic_tick_ FMSession_FMStatus_FMSize"; content:"POST"; http_method; content:"/update?id="; http_uri; content:"&tick="; http_uri; content:"&FMSession="; http_uri; sid: 1000009; rev: 1;)
alert tcp any any -> any 80 (msg:"Sogu/PLUGX_FMS Beacon over port 80 /Action.do?Uid= "; flow: established,to_server; content:"POST"; http_method; content:"/Action.do?Uid="; http_uri; content:"SecSession="; http_cookie; content:"SecStatus="; http_cookie; sid: 1000010; rev:1;)
alert tcp any any -> any [80,443] (msg:"PLUGX malware variant beacon"; content:"POST"; http_method; content:"|0d 0a|LZ-ID|3a 20|"; content:"|0d 0a|LZ-Ver|3a 20|"; content:"|0d 0a|LZ-Compress|3a 20|"; content:"|0d 0a|LZ-Size|3a 20|"; content:"|0d 0a|Host|3a 20|"; sid: 1000011; rev: 1;)
alert tcp any any -> any [80,443] (msg:"Sakula_Implant_Traffic_POST_asp?imageid"; content:"POST"; http_method; content:".asp?imageid="; content:"&type="; content:"User-Agent: iexplorer"; http_header; sid: 1000012; rev: 1;)
alert tcp any any -> any [80,443] (msg:"Sakula_Implant_Traffic_GET_jpg?resid="; content:"GET"; http_method; content:"resid="; content:"User-Agent: iexplorer"; http_header; sid: 1000013; rev: 1;)
alert tcp any any -> any [80,443] (msg:"Sakula_Implant_Traffic_GET_jpg?vid="; content:"GET"; http_method; content:".jpg?vid="; http_uri; sid: 1000014; rev: 1;)
alert tcp any any -> any [80,443] (msg:"Sakula_Implant_Traffic_POST_ asp?cookie"; content:"POST"; http_method; content:".asp?cookie="; http_uri; content:"type="; http_uri; sid: 1000015; rev: 1;)
alert tcp any any -> any [80,443] (msg:"Sakula_Implant_Traffic_POST_ asp?cookie"; content:"POST"; http_method; content:".asp?cstring="; http_uri; content:"type="; http_uri; sid: 1000016; rev: 1;)
alert tcp any any <> any any (msg:"Encrypted Gh0st malware beacon"; flags:PA; content:"|dd35df4b09|"; offset:0; depth: 5; sid: 1000017;)
alert tcp any any <> any any (msg:"Encrypted Gh0st malware beacon"; flags:PA; content:"|4B 8D 39 08 51|"; depth:5; content: "|CE 4D 3E 7C 2F 61 52 DC 61 12 4B FD 6D 0F 71 72 55|"; distance: 28; sid: 1000018;)
alert tcp any any <> any any (msg: "Gh0st_clarkclar1"; content:"clarkclar"; offset:0; depth:9; pcre: "/^clarkclar.\x00\x00....\x00\x00\x78\x9c/s";sid: 1000019;)
alert tcp any any <> any any (msg: "Gh0st_aaaaabbbbb"; content:"aaaaabbbbb"; offset:0; depth:10; pcre: "/^aaaaabbbbb\x00\x00....\x00\x00\x78\x9c/s";sid: 1000020;)
alert tcp any any -> any 80 (msg:"Customized Gh0st Variant Initial Connection"; content:"|48 54 54 50 5C 31 2E 31 20 53 79 63 6D 65 6E 74 65 63|"; depth:18; sid:1000021; rev:1;)
alert tcp any any -> $HOME_NET any (msg:"PROBE_COMMON_UA"; content:"| 4d 6f 7a 69 6c 6c 61 2f 35 2e 30 20 28 57 69 6e 64 6f 77 73 20 4e 54 20 35 2e 31 29 20 41 70 70 6c 65 57 65 62 4b 69 74 2f 35 33 34 2e 32 34 20 28 4b 48 54 4d 4c 2c 20 6c 69 6b 65 20 47 65 63 6b 6f 29 20 43 68 72 6f 6d 65 2f 31 31 2e 30 2e 36 39 36 2e 36 38 20 53 61 66 61 72 69 2f 35 33 34 2e 32 34|"; sid: 1000022;)
alert tcp 111.196.170.0/24 $HIGH_PORTS -> $HOME_NET $HIGH_PORTS (msg:" BEIJING_170_PROBES"; flags:A; sid: 1000023;)